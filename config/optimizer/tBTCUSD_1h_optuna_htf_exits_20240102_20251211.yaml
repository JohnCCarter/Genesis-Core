description: "Optuna - HTF exits tuning (2024-01-02..2025-12-11, within frozen data)"
# NOTE:
# - Same HTF-exit-focused parameter space as the 2026 config, but adjusted to the currently
#   available frozen candle range (tBTCUSD_1h_frozen.parquet ends 2025-12-11).
# - Intended as a runnable alternative until 2026 candles are fetched/frozen.

meta:
  symbol: tBTCUSD
  timeframe: 1h
  snapshot_id: snap_tBTCUSD_2024-01-02_2025-12-11_v1
  runs:
    strategy: optuna
    resume: false
    max_trials: 20000
    max_concurrent: 1
    promotion:
      enabled: false
    use_sample_range: true
    sample_start: "2024-01-02"
    sample_end: "2025-12-11"
    optuna:
      study_name: "optuna_htf_exits_20240102_20251211_fresh_pf055"
      storage: "sqlite:///results/hparam_search/storage/optuna_tBTCUSD_1h_htf_exits_20240102_20251211_fresh_pf055.db"
      n_jobs: 1
      timeout_seconds: 229000
      pruner:
        type: "none"
      sampler:
        type: "tpe"
        kwargs:
          n_startup_trials: 15
          n_ei_candidates: 64
          multivariate: true
          group: true
          seed: 42

constraints:
  min_trades: 1
  min_profit_factor: 0.55
  max_max_dd: 0.5
  include_scoring_failures: false

parameters:
  thresholds:
    entry_conf_overall:
      type: fixed
      value: 0.24

    regime_proba:
      balanced:
        type: fixed
        value: 0.46
      bull:
        type: fixed
        value: 0.50
      bear:
        type: fixed
        value: 0.44
      ranging:
        type: fixed
        value: 0.46

    min_edge:
      type: fixed
      value: 0.01

    signal_adaptation:
      atr_period:
        type: fixed
        value: 28
      zones:
        low:
          entry_conf_overall:
            type: fixed
            value: 0.25
          regime_proba:
            type: fixed
            value: 0.36
        mid:
          entry_conf_overall:
            type: fixed
            value: 0.32
          regime_proba:
            type: fixed
            value: 0.44
        high:
          entry_conf_overall:
            type: fixed
            value: 0.38
          regime_proba:
            type: fixed
            value: 0.56

  exit:
    exit_conf_threshold:
      type: fixed
      value: 0.42
    max_hold_bars:
      type: fixed
      value: 12
    trailing_stop_pct:
      type: fixed
      value: 0.015

  risk: {}

  htf_fib:
    entry:
      missing_policy:
        type: fixed
        value: "pass"

  ltf_fib:
    entry:
      missing_policy:
        type: fixed
        value: "pass"

  htf_exit_config:
    partial_1_pct:
      type: float
      low: 0.50
      high: 0.70
      step: 0.02
    partial_2_pct:
      type: float
      low: 0.35
      high: 0.60
      step: 0.05
    fib_threshold_atr:
      type: float
      low: 0.70
      high: 0.95
      step: 0.05
    trail_atr_multiplier:
      type: float
      low: 2.40
      high: 3.40
      step: 0.10

    enable_partials:
      type: fixed
      value: true
    enable_trailing:
      type: fixed
      value: true
    enable_structure_breaks:
      type: fixed
      value: true
