meta:
  symbol: tBTCUSD
  timeframe: 1h
  snapshot_id: tBTCUSD_1h_2024-10-22_2025-10-01_v1
  warmup_bars: 150
  runs:
    strategy: optuna
    max_trials: 10
    max_concurrent: 4
    resume: false
    use_sample_range: true
    sample_start: 2024-10-22
    sample_end: 2025-10-01
    optuna:
      storage: sqlite:///results/hparam_search/storage/optuna_tBTCUSD_1h_smoke_loose_20251113b.db
      study_name: smoke_loose_20251113b
      bootstrap_random_trials: 32
      bootstrap_seed: 42
      sampler:
        name: tpe
        kwargs:
          n_startup_trials: 100
          n_ei_candidates: 1024
          constant_liar: true
          multivariate: true
      pruner:
        name: median
        kwargs: {}
      heartbeat_interval: 60
      heartbeat_grace_period: 180
      dedup_guard_enabled: true
      timeout_seconds: 172800

constraints:
  min_trades: 1
  min_profit_factor: 0.0
  max_max_dd: 1.0
  include_scoring_failures: false

parameters:
  thresholds:
    entry_conf_overall:
      type: float
      low: 0.25
      high: 0.50
    regime_proba:
      balanced:
        type: float
        low: 0.40
        high: 0.90
      bull:
        type: float
        low: 0.35
        high: 0.85
      bear:
        type: float
        low: 0.35
        high: 0.85
      ranging:
        type: float
        low: 0.40
        high: 0.92
    min_edge:
      type: float
      low: 0.0
      high: 0.08
    signal_adaptation:
      type: grid
      values:
        # Genombrott-konfiguration (baseline)
        - atr_period: 14
          zones:
            low:
              entry_conf_overall: 0.25
              regime_proba:
                { ranging: 0.45, bull: 0.45, bear: 0.45, balanced: 0.45 }
            mid:
              entry_conf_overall: 0.28
              regime_proba:
                { ranging: 0.50, bull: 0.50, bear: 0.50, balanced: 0.50 }
            high:
              entry_conf_overall: 0.32
              regime_proba:
                { ranging: 0.55, bull: 0.55, bear: 0.55, balanced: 0.55 }
        # Lite lägre (mer aggressiv)
        - atr_period: 14
          zones:
            low:
              entry_conf_overall: 0.23
              regime_proba:
                { ranging: 0.42, bull: 0.42, bear: 0.42, balanced: 0.42 }
            mid:
              entry_conf_overall: 0.26
              regime_proba:
                { ranging: 0.47, bull: 0.47, bear: 0.47, balanced: 0.47 }
            high:
              entry_conf_overall: 0.30
              regime_proba:
                { ranging: 0.52, bull: 0.52, bear: 0.52, balanced: 0.52 }
        # Lite högre (mer konservativ)
        - atr_period: 14
          zones:
            low:
              entry_conf_overall: 0.27
              regime_proba:
                { ranging: 0.48, bull: 0.48, bear: 0.48, balanced: 0.48 }
            mid:
              entry_conf_overall: 0.30
              regime_proba:
                { ranging: 0.53, bull: 0.53, bear: 0.53, balanced: 0.53 }
            high:
              entry_conf_overall: 0.34
              regime_proba:
                { ranging: 0.58, bull: 0.58, bear: 0.58, balanced: 0.58 }
        # Variation med asymmetriska regime-trösklar
        - atr_period: 14
          zones:
            low:
              entry_conf_overall: 0.25
              regime_proba:
                { ranging: 0.48, bull: 0.43, bear: 0.43, balanced: 0.45 }
            mid:
              entry_conf_overall: 0.28
              regime_proba:
                { ranging: 0.53, bull: 0.48, bear: 0.48, balanced: 0.50 }
            high:
              entry_conf_overall: 0.32
              regime_proba:
                { ranging: 0.58, bull: 0.53, bear: 0.53, balanced: 0.55 }
        # Bred tolerans (maximal aggressivitet)
        - atr_period: 14
          zones:
            low:
              entry_conf_overall: 0.20
              regime_proba:
                { ranging: 0.38, bull: 0.38, bear: 0.38, balanced: 0.38 }
            mid:
              entry_conf_overall: 0.24
              regime_proba:
                { ranging: 0.43, bull: 0.43, bear: 0.43, balanced: 0.43 }
            high:
              entry_conf_overall: 0.28
              regime_proba:
                { ranging: 0.48, bull: 0.48, bear: 0.48, balanced: 0.48 }
  gates:
    hysteresis_steps:
      type: int
      low: 0
      high: 4
  risk:
    risk_map_deltas:
      conf_0:
        type: float
        low: -0.12
        high: 0.12
      size_0:
        type: float
        low: -0.010
        high: 0.015
      conf_1:
        type: float
        low: -0.12
        high: 0.12
      size_1:
        type: float
        low: -0.012
        high: 0.018
      conf_2:
        type: float
        low: -0.12
        high: 0.12
      size_2:
        type: float
        low: -0.015
        high: 0.020
  exit:
    exit_conf_threshold:
      type: float
      low: 0.20
      high: 0.70
    max_hold_bars:
      type: int
      low: 12
      high: 28
  htf_exit_config:
    fib_threshold_atr:
      type: float
      low: 0.50
      high: 0.85
    trail_atr_multiplier:
      type: float
      low: 1.6
      high: 3.0
    enable_partials:
      type: fixed
      value: true
    enable_trailing:
      type: fixed
      value: true
    enable_structure_breaks:
      type: fixed
      value: true
    partial_1_pct:
      type: fixed
      value: 0.6
    partial_2_pct:
      type: fixed
      value: 0.5
    swing_update_strategy:
      type: fixed
      value: fixed
  htf_fib:
    entry:
      enabled:
        type: grid
        values: [false, true]
      missing_policy:
        type: fixed
        value: pass
      tolerance_atr:
        type: float
        low: 0.20
        high: 0.80
      long_min_level:
        type: fixed
        value: 0.382
      short_max_level:
        type: fixed
        value: 0.618
  ltf_fib:
    entry:
      enabled:
        type: grid
        values: [false, true]
      missing_policy:
        type: fixed
        value: pass
      tolerance_atr:
        type: float
        low: 0.20
        high: 0.80
      long_max_level:
        type: float
        low: 0.700
        high: 0.920
      short_min_level:
        type: float
        low: 0.200
        high: 0.400
      override_confidence:
        enabled:
          type: grid
          values: [true, false]
        min:
          type: float
          low: 0.10
          high: 0.65
        max:
          type: float
          low: 0.45
          high: 0.95
  multi_timeframe:
    use_htf_block:
      type: grid
      values: [false, true]
    allow_ltf_override:
      type: grid
      values: [true, false]
    ltf_override_threshold:
      type: float
      low: 0.35
      high: 0.95
    ltf_override_adaptive:
      enabled:
        type: grid
        values: [true, false]
      window:
        type: int
        low: 120
        high: 360
        step: 20
      percentile:
        type: float
        low: 0.70
        high: 0.95
      min_history:
        type: fixed
        value: 120
      min_floor:
        type: float
        low: 0.35
        high: 0.75
      max_ceiling:
        type: float
        low: 0.90
        high: 0.995
      fallback_threshold:
        type: float
        low: 0.60
        high: 0.92
      regime_multipliers:
        type: fixed
        value:
          bull: 0.95
          bear: 1.05
